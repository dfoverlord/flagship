{% extends 'base_iam.html' %}

{% load form_tags widget_tweaks %}

{% block title %}My Profile{% endblock %}

{% block page_content %}
	<div class="row justify-content-center">
		<div class="col-lg-6 col-md-8 col-sm-10">
			<div class="media">
				<img class="rounded-circle account-img" src="{{ user.profile.image.url }}">
				<div class="media-body">
					<h2 class="account-heading">{{ user.username }}</h2>
					<p class="text-secondary">{{ user.email }}</p>
				</div>
			</div>
		
			<form method="post" enctype="multipart/form-data">
				{% csrf_token %}
				<div class="form-group">
					<legend class="border-bottom mb-4">Profile Info</legend>
					
					<!-- Deal with User form -->
					{% if user_form.non_field_errors %}
						<div class="alert alert-danger" role="alert">
							{% for error in user_form.non_field_errors %}
								<p{% if forloop.last %} class="mb-0"{% endif %}>{{ error }}</p>
							{% endfor %}
						</div>
					{% endif %}
					
					{% for field in user_form %}
						<div class="form-group">
							{{ field.label_tag }}
							{% render_field field class=field|input_class %}
							{% for error in field.errors %}
								<div class="invalid-feedback">
									{{ error }}
								</div>
							{% endfor %}
							{% if field.help_text %}
								<small class="form-text text-muted">
									{{ field.help_text|safe }}
								</small>
							{% endif %}
						</div>
					{% endfor %}
					
					<!-- Deal with Profile form -->
					{% if profile_form.non_field_errors %}
						<div class="alert alert-danger" role="alert">
							{% for error in profile_form.non_field_errors %}
								<p{% if forloop.last %} class="mb-0"{% endif %}>{{ error }}</p>
							{% endfor %}
						</div>
					{% endif %}
					
					{% for field in profile_form %}
						<div class="form-group">
							{{ field.label_tag }}
							{% render_field field class=field|input_class %}
							{% for error in field.errors %}
								<div class="invalid-feedback">
									{{ error }}
								</div>
							{% endfor %}
							{% if field.help_text %}
								<small class="form-text text-muted">
									{{ field.help_text|safe }}
								</small>
							{% endif %}
						</div>
					{% endfor %}
				
				</div>
				<div class="form-group">
					<button type="submit" class="btn btn-success">Save Changes</button>
				</div>
			</form>
		</div>
	</div>
{% endblock %}